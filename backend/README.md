# Анализатор документов (Backend)

Backend часть веб-приложения "Анализатор документов" написана на FastAPI.
В качестве СУБД используется PostgreSQL. Для обработки текстовых данных документов используется библиотека TextBlob.
Серверная часть покрыта интеграционными тестами.

# Разработка

## Требования

Для установки и запуска проекта в режиме разработки необходим
[Python3.12](https://www.python.org/downloads/release/python-3120/), а также [Poetry](https://python-poetry.org/).

## Установка переменных окружения

Создайте файл .env, скопируйте данные из файла [.env.tests](.env.tests) и замените DB_NAME

```bash
cp .env.tests .env
vim .env
```

## Установка зависимостей

Для установки зависимостей и активации виртуального окружения выполните команду:

```bash
poetry install

poetry shell
```

## Docker

Для запуска контейнеров Docker c backend и с базой данных в root директории проекта используйте команду:

```bash
docker compose up -d my_app
```

## Создание и обновление схем в базе данных

Для создания и обновления схем в базе данных используйте команду:

```bash
alembic upgrade head
```

## Запуск Development сервера

Чтобы запустить сервер для разработки, выполните команду:

```bash
python -m main
```

## Тестирование

Для тестирования требуется создать тестовую базу данных. Смотрите файл [.env.tests](.env.tests)

Для создания тестовой базы данных используйте следующие комнады:

```bash
docker compose exec -it db psql -U user <db_name>
CREATE DATABASE document_parser_db_test;
```

Для запуска тестов используйте команду:

```bash
pytest tests
```

## Форматирование и проверка кода

Для форматирования кода используйте команды из файла [Makefile](Makefile):

```bash
make fix
make check
```
